<div class="settings-container">
  <div class="page-header">
    <div class="page-header-left">
      <h2>Settings</h2>
    </div>
  </div>

  <div class="settings-content">

    <mat-card class="settings-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>router</mat-icon>
          KNX Gateway Configuration
        </mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <div class="config-grid">
          <mat-form-field appearance="outline">
            <mat-label>IP Address</mat-label>
            <input
              matInput
              [(ngModel)]="knxConfig.ipAddress"
              placeholder="192.168.1.100"
              required
              pattern="^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$"
            >
            <mat-icon matPrefix>language</mat-icon>
            <mat-hint>IP address of your KNX interface</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Port</mat-label>
            <input
              matInput
              type="number"
              [(ngModel)]="knxConfig.port"
              placeholder="3671"
              required
              min="1"
              max="65535"
            >
            <mat-icon matPrefix>settings_ethernet</mat-icon>
            <mat-hint>Default: 3671 (KNXnet/IP)</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Physical Address</mat-label>
            <input
              matInput
              [(ngModel)]="knxConfig.physicalAddress"
              placeholder="1.0.58"
              required
              pattern="^\d{1,2}\.\d{1,2}\.\d{1,3}$"
            >
            <mat-icon matPrefix>badge</mat-icon>
            <mat-hint>Format: Area.Line.Device (e.g. 1.0.58)</mat-hint>
          </mat-form-field>
        </div>

        <div class="info-box">
          <mat-icon>info</mat-icon>
          <div class="info-content">
            <span><strong>Connection:</strong> IP Tunneling (UDP) â€¢ <strong>Protocol:</strong> KNXnet/IP</span>
          </div>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <div class="button-group primary-actions">
          <button mat-raised-button color="primary" (click)="saveSettings()" [disabled]="isSaving || !isFormValid()">
            <mat-icon>save</mat-icon>
            {{ isSaving ? 'Saving...' : 'Save' }}
          </button>

          <button mat-raised-button color="accent" (click)="testConnection()" [disabled]="isTesting || isSaving || !isFormValid()" [class.testing]="isTesting">
            <mat-icon [class.spinning]="isTesting">{{ isTesting ? 'sync' : 'cable' }}</mat-icon>
            {{ isTesting ? 'Testing...' : 'Test Connection' }}
          </button>
        </div>

        <button mat-stroked-button (click)="resetToDefaults()" class="secondary-action">
          <mat-icon>restore</mat-icon>
          Reset
        </button>
      </mat-card-actions>
    </mat-card>

    <div class="storage-note">
      <mat-icon>storage</mat-icon>
      <span>Settings are stored in SQLite database and persist across restarts</span>
    </div>
  </div>
</div>
